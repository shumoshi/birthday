<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://fonts.googleapis.com/css2?family=Zen+Kurenaido&display=swap" rel="stylesheet">
    <title>æ¡ƒå­ç”Ÿèª•ç¥­2DAYS - ãƒŸãƒƒã‚·ãƒ§ãƒ³ä¸€è¦§</title>
    <style>
        /* ---ä¸­ç•¥--- ã™ã¹ã¦å…ƒã®ã¾ã¾ --- */
        /* â–¼ã‚¹ã‚¿ãƒ³ãƒ—æ¼”å‡ºã‚¢ãƒ‹ãƒ¡ã‚’è¿½åŠ  */
        @keyframes stampPop {
          0%   { transform: scale(1);}
          50%  { transform: scale(1.22);}
          100% { transform: scale(1);}
        }
        .mission-card.completed.stamp-pop {
          animation: stampPop 0.6s cubic-bezier(.6,1.7,.9,.8) 1;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- ...ä¸­ç•¥... -->
        <div class="mission-grid" id="missionGrid">
            <!-- ãƒŸãƒƒã‚·ãƒ§ãƒ³ãŒå‹•çš„ã«ç”Ÿæˆã•ã‚Œã‚‹ -->
        </div>
        <button class="reset-button" onclick="resetAll()">ğŸ”„ ãƒªã‚»ãƒƒãƒˆ</button>
    </div>

    <!-- ã‚µã‚¦ãƒ³ãƒ‰ -->
    <audio id="bgm-audio" src="bgm.mp3" loop></audio>
    <audio id="clear-audio" src="clear.mp3"></audio>

    <script>
        let missions = [
            /* ---ä¸­ç•¥--- */
        ];
        let completed = JSON.parse(localStorage.getItem('completed') || '[]');

        function init() {
            // BGMåˆæœŸåŒ–ï¼ˆiOSå¯¾ç­–ã§ã‚¯ãƒªãƒƒã‚¯ä»¥é™å†ç”Ÿã‚‚è‡ªå‹•ã‚»ãƒƒãƒˆï¼‰
            const bgm = document.getElementById('bgm-audio');
            if (bgm) {
                bgm.volume = 0.12;
                // ãƒ¦ãƒ¼ã‚¶ãƒ¼æ“ä½œã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§ã‚‚å†ç”Ÿã‚»ãƒƒãƒˆ
                document.body.addEventListener('click', ()=>{ if(bgm.paused) bgm.play().catch(()=>{}); }, { once: true });
                bgm.play().catch(()=>{});
            }

            checkParams();
            showMissions();
            showProgress();
            showPhotos();
        }

        function addCard(num, mission, done) {
            // ...å…ƒã®ã¾ã¾...
        }

        function completeMission(num) {
            // ã‚¯ãƒªã‚¢éŸ³ï¼†ã‚¹ã‚¿ãƒ³ãƒ—æ¼”å‡º
            try {
                const audio = document.getElementById('clear-audio');
                audio.currentTime = 0;
                audio.play().catch(()=>{});
            } catch(e){}
            // ã‚¹ã‚¿ãƒ³ãƒ—æ¼”å‡º
            setTimeout(() => {
                const grid = document.getElementById('missionGrid');
                const cards = grid.querySelectorAll('.mission-card');
                cards.forEach(card => {
                    if (!card.classList.contains('completed')) {
                        card.classList.add('stamp-pop');
                        setTimeout(()=>{ card.classList.remove('stamp-pop'); }, 700);
                    }
                });
            }, 10);

            completed.push(num);
            localStorage.setItem('completed', JSON.stringify(completed));
            window.location.href = `draw.html?mission=${num}`;
        }

        // ---æ®‹ã‚Šã®é–¢æ•°ã¯å…¨éƒ¨ãã®ã¾ã¾ï¼---

        window.addEventListener('load', init);
    </script>
</body>
</html>
